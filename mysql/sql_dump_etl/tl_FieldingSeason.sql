--
-- Creates FieldingSeason
--

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;


CREATE DATABASE IF NOT EXISTS immaculateGrid;
USE immaculateGrid;


DROP TABLE IF EXISTS `FieldingSeason`;

/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;

CREATE TABLE `FieldingSeason` (
    `playerID` VARCHAR(10),
    `teamID` VARCHAR(4),
    `year` INT,
    `P` TINYINT,
    `C` TINYINT,
    `1B` TINYINT,
    `2B` TINYINT,
    `3B` TINYINT,
    `SS` TINYINT,
    `LF` TINYINT,
    `CF` TINYINT,
    `RF` TINYINT,
    `DH` TINYINT,
    PRIMARY KEY (`playerID`, `teamID`, `year`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

INSERT INTO `FieldingSeason` (playerID, teamID, year, P, C, 1B, 2B, 3B, SS, LF, CF, RF, DH)
SELECT
	playerID,
	teamID,
	yearID as year,
	CASE WHEN SUM(G_p) > 0 THEN 1 ELSE 0 END AS P,
	CASE WHEN SUM(G_c) > 0 THEN 1 ELSE 0 END AS C,
    CASE WHEN SUM(G_1b) > 0 THEN 1 ELSE 0 END AS 1B,
	CASE WHEN SUM(G_2b) > 0 THEN 1 ELSE 0 END AS 2B,
	CASE WHEN SUM(G_3b) > 0 THEN 1 ELSE 0 END AS 3B,
	CASE WHEN SUM(G_ss) > 0 THEN 1 ELSE 0 END AS SS,
	CASE WHEN SUM(G_lf) > 0 THEN 1 ELSE 0 END AS LF,
	CASE WHEN SUM(G_cf) > 0 THEN 1 ELSE 0 END AS CF,
	CASE WHEN SUM(G_rf) > 0 THEN 1 ELSE 0 END AS RF,
	CASE WHEN SUM(G_dh) > 0 THEN 1 ELSE 0 END AS DH
FROM Appearances
GROUP BY playerID, teamID, yearID;

DROP TABLE `Appearances`;
